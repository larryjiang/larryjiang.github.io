<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>A Note on Java Memory Model: A Buttom-up Perspective | Trails</title><link rel="stylesheet" type="text/css" href="/public/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/public/favicon.ico"><link rel="apple-touch-icon" href="/public/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/public/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">A Note on Java Memory Model: A Buttom-up Perspective</h1><a id="logo" href="/public/.">Trails</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/public/."><i class="fa fa-home"> Home</i></a><a href="/public/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/public/about/"><i class="fa fa-user"> About</i></a><a href="/public/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">A Note on Java Memory Model: A Buttom-up Perspective</h1><div class="post-meta">Dec 17, 2017<span> | </span><span class="category"><a href="/public/categories/Java/">Java</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Preface"><span class="toc-number">1.</span> <span class="toc-text"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Disclaimer"><span class="toc-number">2.</span> <span class="toc-text"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-is-the-exact-definition-and-to-what-extent-should-we-master-it"><span class="toc-number">3.</span> <span class="toc-text"><a href="#What-is-the-exact-definition-and-to-what-extent-should-we-master-it" class="headerlink" title="What is the exact definition, and to what extent should we master it"></a>What is the exact definition, and to what extent should we master it</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prerequisites"><span class="toc-number">4.</span> <span class="toc-text"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reorders"><span class="toc-number">4.1.</span> <span class="toc-text"><a href="#Reorders" class="headerlink" title="Reorders"></a>Reorders</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Compiler-Optimization"><span class="toc-number">4.1.1.</span> <span class="toc-text"><a href="#Compiler-Optimization" class="headerlink" title="Compiler Optimization"></a>Compiler Optimization</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Out-of-order-Execution"><span class="toc-number">4.1.2.</span> <span class="toc-text"><a href="#Out-of-order-Execution" class="headerlink" title="Out-of-order Execution"></a>Out-of-order Execution</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-key-points-in-understanding-the-JMM-Model"><span class="toc-number">5.</span> <span class="toc-text"><a href="#Some-key-points-in-understanding-the-JMM-Model" class="headerlink" title="Some key points in understanding the JMM Model"></a>Some key points in understanding the JMM Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">6.</span> <span class="toc-text"><a href="#References" class="headerlink" title="References"></a>References</span></a></li></ol></div></div><div class="post-content"><h3 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h3><p>Java Memory Model(abbr. JMM later) has been and will alway be one of the most fundamental and hardest area to understand. Yet, in learning java language, we just can not circumvent this topic. Without deep understanding of Java Memory Model, it is hard to write correct concurrent programs in java. <a id="more"></a>However, mastering JMM needs significant system level knowledge like computer architecture, operating system, compilers, etc. This note mainly aims to record the process how I understand and learn this topic over time. </p>
<h3 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h3><p>This topic will be update to date and it is not ganranteed that opinions given here are correct. Origins of the references used in this paper will be given <a href="#references">References</a>. </p>
<h3 id="What-is-the-exact-definition-and-to-what-extent-should-we-master-it"><a href="#What-is-the-exact-definition-and-to-what-extent-should-we-master-it" class="headerlink" title="What is the exact definition, and to what extent should we master it"></a>What is the exact definition, and to what extent should we master it</h3><p>What does JMM do exactly, and why does java have its language level memory model? Before delving into any specifics of Java Memory model, we need to be able to answer thoes two questions. After extensive reading and thinking, I can only answer thoes two questions by citations from gurus in this field. Put it simply and bluntly, I think the answer to the first question in my opinion could be:</p>
<ul>
<li>In storage-savvy languages, the memory models appear to answer a simple question:”What values can a particular read observe?”<sup><a href="#ref-1">1</a></sup></li>
</ul>
<p>and the answer to the second may be:</p>
<ul>
<li>Java have built-in support for synchronizaiton and is claimed to be cross-platform, which means it should abstract aways the low level details and promote synchronization into language level.</li>
</ul>
<h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><h4 id="Reorders"><a href="#Reorders" class="headerlink" title="Reorders"></a>Reorders</h4><p>If all the instructions were to be executed sequentially, it will be a lot easier for us to understand the outcome of a program. However, it is just not the case. Compilers and Operating Systems are free to reorder instructions so that our code is executed more efficiently. Understanding all kinds of reorders may help us comprehend the design behind the JMM. </p>
<h5 id="Compiler-Optimization"><a href="#Compiler-Optimization" class="headerlink" title="Compiler Optimization"></a>Compiler Optimization</h5><h5 id="Out-of-order-Execution"><a href="#Out-of-order-Execution" class="headerlink" title="Out-of-order Execution"></a>Out-of-order Execution</h5><h3 id="Some-key-points-in-understanding-the-JMM-Model"><a href="#Some-key-points-in-understanding-the-JMM-Model" class="headerlink" title="Some key points in understanding the JMM Model"></a>Some key points in understanding the JMM Model</h3><ul>
<li>Understanding the <strong>built-in</strong> synchronization mechanism</li>
<li>Understanding the <strong>volatile</strong> keyword, its influence on memory visibility as well as its impact on instruction reordering</li>
<li>Unserstanding the semantics of <strong>final</strong> keyword and its influence on object initialization</li>
</ul>
<p><a name="references"></a></p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ol>
<li><a name="ref-1" href="https://shipilev.net/blog/2014/jmm-pragmatics/" target="_blank" rel="noopener">Java Memory Model Pragmatics</a></li>
<li><a name="ref-2" href="http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html" target="_blank" rel="noopener">Famous JSR133 FAQ</a></li>
<li><a name="ref-3" href="http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-95-7.pdf" target="_blank" rel="noopener">Shared Memory Consistency Models: A Tutorial</a></li>
<li><a name="ref-4" href="https://docs.oracle.com/javase/specs/" target="_blank" rel="noopener">Java Language and Virtual Machine Specification</a></li>
</ol>
</div><div class="tags"><a href="/public/tags/java/">java</a><a href="/public/tags/jmm/">jmm</a><a href="/public/tags/java-memory-model/">java memory model</a><a href="/public/tags/computer-architecture/">computer architecture</a><a href="/public/tags/memory/">memory</a><a href="/public/tags/thread/">thread</a><a href="/public/tags/os/">os</a><a href="/public/tags/PL-Compilers/">PL/Compilers</a></div><div class="post-nav"><a class="next" href="/public/2017/12/16/first.html">Genesis</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://larryjiang.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/public/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/public/categories/Site-Meta/">Site Meta</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/public/tags/author/" style="font-size: 15px;">author</a> <a href="/public/tags/meta/" style="font-size: 15px;">meta</a> <a href="/public/tags/java/" style="font-size: 15px;">java</a> <a href="/public/tags/jmm/" style="font-size: 15px;">jmm</a> <a href="/public/tags/java-memory-model/" style="font-size: 15px;">java memory model</a> <a href="/public/tags/computer-architecture/" style="font-size: 15px;">computer architecture</a> <a href="/public/tags/memory/" style="font-size: 15px;">memory</a> <a href="/public/tags/thread/" style="font-size: 15px;">thread</a> <a href="/public/tags/os/" style="font-size: 15px;">os</a> <a href="/public/tags/PL-Compilers/" style="font-size: 15px;">PL/Compilers</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/public/2017/12/17/jmm-illustrated.html">A Note on Java Memory Model: A Buttom-up Perspective</a></li><li class="post-list-item"><a class="post-list-link" href="/public/2017/12/16/first.html">Genesis</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/public/." rel="nofollow">Trails.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/public/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/public/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/public/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/public/js/smartresize.js?v=0.0.0"></script></div></body></html>